// This autogenerated skeleton file illustrates how to build a server.
// You should copy it to another filename to avoid overwriting it.

#include "SettingSystemService.h"
#include <thrift/protocol/TBinaryProtocol.h>
#include <thrift/server/TSimpleServer.h>
#include <thrift/transport/TServerSocket.h>
#include <thrift/transport/TBufferTransports.h>

using namespace ::apache::thrift;
using namespace ::apache::thrift::protocol;
using namespace ::apache::thrift::transport;
using namespace ::apache::thrift::server;

using boost::shared_ptr;

using namespace  ::Ruyi::SDK::SettingSystem::Api;

class SettingSystemServiceHandler : virtual public SettingSystemServiceIf {
 public:
  SettingSystemServiceHandler() {
    // Your initialization goes here
  }

  /**
   * Get a setting data of the module.
   * 
   * @param id The setting's unique id in current module.
   */
  void GetSettingItem( ::Ruyi::SDK::CommonType::SettingItem& _return, const std::string& id) {
    // Your implementation goes here
    printf("GetSettingItem\n");
  }

  /**
   * Get a list of setting data of the module.
   * 
   * @param category Category to filter the settings. Null indicates getting all settings of the module
   * 
   * @param includeChildren Whecher to get the settings of children cagegories.
   */
  void GetSettingItems(std::vector< ::Ruyi::SDK::CommonType::SettingItem> & _return, const std::string& category, const bool includeChildren) {
    // Your implementation goes here
    printf("GetSettingItems\n");
  }

  /**
   * Search a set of settings using a json format string.
   * According to the format of json string your write, searching can be separated to 3 types: simple search, lambda search and complicated search. And each of they can be combined with the other.
   * 
   * @param filterJson Json string used to search.
   */
  void SearchSettingItems(std::map<std::string,  ::Ruyi::SDK::SettingSystem::Api::SettingSearchResult> & _return, const std::string& filterJson) {
    // Your implementation goes here
    printf("SearchSettingItems\n");
  }

  /**
   * Get settings and categories in a tree
   */
  void GetCategoryNode( ::Ruyi::SDK::SettingSystem::Api::SettingTree& _return) {
    // Your implementation goes here
    printf("GetCategoryNode\n");
  }

  void GetChildNode( ::Ruyi::SDK::SettingSystem::Api::NodeList& _return, const std::string& parent, const  ::Ruyi::SDK::SettingSystem::Api::NodeType::type nodeType) {
    // Your implementation goes here
    printf("GetChildNode\n");
  }

  /**
   * Set the specified setting's "dataValue" with the new value
   * 
   * @param key Identity of the setting
   * 
   * @param val Value to be set
   */
  bool SetSettingItem(const std::string& key, const std::string& val) {
    // Your implementation goes here
    printf("SetSettingItem\n");
  }

  /**
   * Set a set of settings' "dataValue"
   * 
   * @param keyValues The key-values to be set.
   */
  int32_t SetSettingItems(const std::map<std::string, std::string> & keyValues) {
    // Your implementation goes here
    printf("SetSettingItems\n");
  }

  /**
   * Restore a module setting to default
   * 
   * @param moduleName Module name specifies the module to be restored.
   * 
   * @param category The category of which to restored. Null indicates all settings.
   */
  bool RestoreDefault(const std::string& moduleName, const std::string& category) {
    // Your implementation goes here
    printf("RestoreDefault\n");
  }

  bool RestoreUserDefault(const std::string& userId, const std::string& moduleName, const std::string& category) {
    // Your implementation goes here
    printf("RestoreUserDefault\n");
  }

  /**
   * Update the module settings from an older version to the latest one
   * 
   * @param moduleName Module of the setting
   */
  bool UpdateModuleVersion(const std::string& moduleName) {
    // Your implementation goes here
    printf("UpdateModuleVersion\n");
  }

  int32_t SetUserAppData(const std::string& userId, const std::string& category, const std::map<std::string,  ::Ruyi::SDK::SettingSystem::Api::JSON> & settingItems) {
    // Your implementation goes here
    printf("SetUserAppData\n");
  }

  void GetUserAppData( ::Ruyi::SDK::SettingSystem::Api::AppData& _return, const std::string& userId, const std::string& category, const std::vector<std::string> & settingKeys) {
    // Your implementation goes here
    printf("GetUserAppData\n");
  }

  int32_t RemoveUserAppData(const std::string& userId, const std::string& category, const std::vector<std::string> & settingKeys) {
    // Your implementation goes here
    printf("RemoveUserAppData\n");
  }

};

int main(int argc, char **argv) {
  int port = 9090;
  shared_ptr<SettingSystemServiceHandler> handler(new SettingSystemServiceHandler());
  shared_ptr<TProcessor> processor(new SettingSystemServiceProcessor(handler));
  shared_ptr<TServerTransport> serverTransport(new TServerSocket(port));
  shared_ptr<TTransportFactory> transportFactory(new TBufferedTransportFactory());
  shared_ptr<TProtocolFactory> protocolFactory(new TBinaryProtocolFactory());

  TSimpleServer server(processor, serverTransport, transportFactory, protocolFactory);
  server.serve();
  return 0;
}

